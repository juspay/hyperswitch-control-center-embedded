{"version":3,"file":"index.min.js","sources":["../src/element.ts","../src/connector-configuration.ts","../src/hyperswitch.ts","../src/init-config.ts","../src/index.ts"],"sourcesContent":["import { Hyperswitch } from './hyperswitch';\nimport { ElementOptions } from './types';\n\nconst isBrowser = typeof window !== 'undefined' && typeof document !== 'undefined';\n\nabstract class HyperswitchElement {\n  protected instance: Hyperswitch;\n  protected options: ElementOptions;\n  public element!: HTMLElement;\n  protected iframe!: HTMLIFrameElement;\n  private boundMessageHandler: ((event: MessageEvent) => void) | null;\n  public readonly _internalId: string;\n  \n  constructor(instance: Hyperswitch, options?: ElementOptions) {\n    this.instance = instance;\n    this.options = options || {};\n    this._internalId = `hyper-el-${Math.random().toString(36).substring(7)}`;\n    this.boundMessageHandler = null;\n    // In SSR / non-browser environments, avoid touching DOM APIs.\n    // The React wrapper only creates and mounts elements on the client,\n    // so it's safe for server-side usage as long as we no-op here.\n    if (!isBrowser) {\n      return;\n    }\n    \n    this.element = document.createElement('div');\n    this.iframe = document.createElement('iframe');\n    this.boundMessageHandler = this.handleMessage.bind(this);\n    \n    this.setupElement();\n    this.setupIframe();\n    window.addEventListener('message', this.boundMessageHandler);\n  }\n\n  private setupElement(): void {\n    if (!isBrowser) {\n      return;\n    }\n\n    this.element.className = `hyperswitch-element ${this.options.className || ''}`.trim();\n    this.element.dataset.hyperswitchElement = this.getElementType();\n    \n    Object.assign(this.element.style, {\n      width: this.options.width || '100%',\n      height: this.options.height || '500px',\n      overflow: 'hidden',\n      ...(this.options.style || {})\n    });\n  }\n  \n  private setupIframe(): void {\n    if (!isBrowser) {\n      return;\n    }\n\n    this.iframe.src = this.getIframeSrc();\n    this.iframe.style.border = 'none';\n    this.iframe.style.width = '100%';\n    this.iframe.style.height = '100%';\n    this.iframe.title = `Hyperswitch ${this.getElementType()}`;\n    this.iframe.setAttribute('allow', 'clipboard-read; clipboard-write; clipboard-sanitized-write');\n    this.iframe.setAttribute('sandbox', 'allow-scripts allow-same-origin allow-popups allow-forms allow-modals allow-presentation allow-downloads');\n    \n    this.element.appendChild(this.iframe);\n  }\n  \n  private handleMessage(event: MessageEvent): void {\n    if (!isBrowser) {\n      return;\n    }\n\n    if (this.options.onMessage) {\n      this.options.onMessage(event.data);\n    }\n    \n    if (event.data?.type === 'EMBEDDED_COMPONENT_RESIZE') {\n      const newHeight = event.data.height;\n      const messageComponent = event.data.component || '';\n      \n      if (messageComponent === this.getElementType() && typeof newHeight === 'number' && newHeight > 0) {\n        this.element.style.height = `${newHeight}px`;\n        \n        if (this.options.onResize) {\n          this.options.onResize({\n            width: this.element.clientWidth,\n            height: newHeight\n          });\n        }\n      }\n    }\n  }\n  \n  mount(domNode: string | HTMLElement): HyperswitchElement {\n    if (!isBrowser) {\n      throw new Error('HyperswitchElement.mount can only be called in a browser environment');\n    }\n\n    const parent = typeof domNode === 'string' \n      ? document.querySelector(domNode) \n      : domNode;\n      \n    if (!parent) {\n      throw new Error(`Invalid mount point: ${domNode}`);\n    }\n    \n    parent.appendChild(this.element);\n    return this;\n  }\n  \n  destroy(): void {\n    if (!isBrowser) {\n      return;\n    }\n    if (this.boundMessageHandler) {\n      window.removeEventListener('message', this.boundMessageHandler);\n    }\n    \n    if (this.element && this.element.parentNode) {\n      this.element.parentNode.removeChild(this.element);\n    }\n  }\n  \n  protected abstract getElementType(): string;\n  protected abstract getIframeSrc(): string;\n\n  public getIframe(): HTMLIFrameElement {\n    return this.iframe;\n  }\n}\n\nexport { HyperswitchElement };\n","import { Hyperswitch } from './hyperswitch';\nimport { HyperswitchElement } from './element';\nimport { ElementOptions } from './types';\n\nexport class ConnectorConfigurationComponent extends HyperswitchElement {\n  constructor(instance: Hyperswitch, options?: ElementOptions) {\n    super(instance, options);\n  }\n  \n  protected getElementType(): string {\n    return 'connectors';\n  }\n  \n  protected getIframeSrc(): string {\n    const baseUrl = this.options.url || 'http://localhost:9000';\n    return `${baseUrl}/embedded/connectors`;\n  }\n}\n","import { HyperswitchElement } from './element';\nimport { ConnectorConfigurationComponent } from './connector-configuration';\nimport { HyperswitchInitOptions } from './types';\nimport { buildInitConfig,InitConfig } from './init-config';\n\nconst isBrowser = typeof window !== 'undefined';\n\nclass Hyperswitch {\n  private token: string | null = null;\n  private fetchToken: () => Promise<string | undefined>;\n  private initConfig: InitConfig | null = null;\n  private activeElements: Map<string, HyperswitchElement> =     new Map();\n  private isRefetchingToken: boolean = false;\n  private initPromise: Promise<void>;\n  private tokenError: string | null = null;\n\n  constructor(options: HyperswitchInitOptions) {\n    if (!options || typeof options.fetchToken !== 'function') {\n      throw new Error('loadHyperswitch requires a fetchToken callback function');\n    }\n\n    this.fetchToken = options.fetchToken;\n     this.initConfig = options.initConfig ? buildInitConfig(options.initConfig) : null;\n    this.initPromise = this.fetchInitialToken();\n    this.listenForMessages();\n  }\n\n  private fetchInitialToken(): Promise<void> {\n    const eagerTokenPromise = (() => {\n      try {\n        return this.fetchToken();\n      } catch (error) {\n        return Promise.reject(error);\n      }\n    })();\n\n    return eagerTokenPromise.then((token) => {\n      if (token) {\n        this.token = token;\n      } else {\n        this.tokenError = 'Failed to fetch token: Token returned empty or undefined';\n      }\n    }).catch((error) => {\n      this.tokenError = `Failed to fetch token: ${error instanceof Error ? error.message : String(error)}`;\n    });\n  } \n\n  private listenForMessages(): void {\n    if (!isBrowser) {\n      // In SSR / non-browser environments we can't listen for postMessage events,\n      // but it's still safe to create a Hyperswitch instance (it will become\n      // useful on the client where another instance will typically be created).\n      return;\n    }\n\n    window.addEventListener(\"message\", async (event) => {\n      if (event.data?.type === \"TOKEN_EXPIRED\" && event.data?.value === true) {\n        await this.refetchAndBroadcastToken();\n      } else if (event.data?.type === \"EMBEDDED_IFRAME_READY\") {\n        // Find the element whose iframe matches the event source\n        this.activeElements.forEach((element) => {\n          const iframe = element.getIframe();\n          if (iframe?.contentWindow === event.source) {\n            this.onElementIframeLoaded(element);\n          }\n        });\n      }\n    });\n  }\n\n  private async refetchAndBroadcastToken(): Promise<void> {\n    if (this.isRefetchingToken) {\n      return;\n    }\n    \n    this.isRefetchingToken = true;\n    \n    try {\n      const newToken = await this.fetchToken();\n      \n      if (newToken) {\n        this.token = newToken;\n        this.tokenError = null;\n        this.activeElements.forEach((element, elementId) => {\n          const iframe = element.getIframe();\n          if (iframe?.contentWindow) {\n            iframe.contentWindow.postMessage({\n              type: 'AUTH_TOKEN',\n              token: this.token\n            }, '*');\n          }\n        });\n      } else {\n        this.tokenError = 'Failed to refetch token: Token returned empty or undefined';\n        this.sendErrorToActiveElements(this.tokenError);\n      }\n    } catch (error) {\n      this.tokenError = `Failed to refetch token: ${error instanceof Error ? error.message : String(error)}`;\n      this.sendErrorToActiveElements(this.tokenError);\n    } finally {\n      this.isRefetchingToken = false;\n    }\n  }\n\n  private sendErrorToActiveElements(errorMessage: string): void {\n    this.activeElements.forEach((element) => {\n      const iframe = element.getIframe();\n      if (iframe?.contentWindow) {\n        iframe.contentWindow.postMessage({\n          type: 'AUTH_ERROR',\n          error: errorMessage\n        }, '*');\n      }\n    });\n  }\n\n  public create(type: string, options?: any): HyperswitchElement {\n    let element: HyperswitchElement;\n    \n    switch (type) {\n      case 'connectors':\n        element = new ConnectorConfigurationComponent(this, options);\n        break;\n      default:\n        throw new Error(`Unknown element type: ${type}`);\n    }\n    \n    this.activeElements.set(element._internalId, element);\n    \n    return element;\n  }\n\n  public onElementIframeLoaded(element: HyperswitchElement): void {\n    this.initPromise.then(() => {\n      const iframe = element.getIframe();\n      if (!iframe?.contentWindow) {\n        return;\n      }\n      \n      setTimeout(() => {\n        try {\n          const contentWindow = iframe.contentWindow;\n          if (!contentWindow) {\n            return;\n          }\n\n          if (this.tokenError) {\n            contentWindow.postMessage({\n              type: 'AUTH_ERROR',\n              error: this.tokenError\n            }, '*');\n          } else if (this.token) {\n            contentWindow.postMessage({\n              type: 'AUTH_TOKEN',\n              token: this.token\n            }, '*');\n          } else {\n            contentWindow.postMessage({\n              type: 'AUTH_ERROR',\n              error: 'No token available'\n            }, '*');\n          }\n\n          // Send init_config (if available) as a separate message\n          if (this.initConfig) {\n            contentWindow.postMessage({\n              type: 'INIT_CONFIG',\n              init_config: this.initConfig\n            }, '*');\n          }\n        } catch (error) {\n        }\n      }, 100);\n    }).catch((error) => {\n      const iframe = element.getIframe();\n      const contentWindow = iframe?.contentWindow;\n      if (contentWindow) {\n        setTimeout(() => {\n          try {\n            contentWindow.postMessage({\n              type: 'AUTH_ERROR',\n              error: `Token initialization failed: ${error instanceof Error ? error.message : String(error)}`\n            }, '*');\n          } catch {\n          }\n        }, 100);\n      }\n    });\n  }\n}\n\nexport function loadHyperswitch(options: HyperswitchInitOptions): Hyperswitch {\n  return new Hyperswitch(options);\n}\n\nexport { Hyperswitch };\n","/**\n * Theme configuration received from the merchant.\n * This is the ONLY contract we expect merchants to follow.\n */\nexport type MerchantTheme = {\n  /** Primary color */\n  primaryColor?: string;\n  /** Page background color */\n  backgroundColor?: string;\n  /** Button configurations */\n  buttons?: {\n    /** Primary button configuration */\n    primary?: {\n      /** Primary button background color */\n      backgroundColor?: string;\n      /** Primary button text color */\n      textColor?: string;\n      /** Primary button hover background color */\n      hoverBackgroundColor?: string;\n    };\n    /** Secondary button configuration */\n    secondary?: {\n      /** Secondary button background color */\n      backgroundColor?: string;\n      /** Secondary button text color */\n      textColor?: string;\n      /** Secondary button hover background color */\n      hoverBackgroundColor?: string;\n    };\n  };\n};\n\n/**\n * Full init_config payload shape sent to the Control Center.\n * Most fields are null for now; Control Center applies defaults.\n */\nexport type InitConfig = {\n  settings: {\n    colors: {\n      primary: string | null;\n      secondary: string | null;\n      background: string | null;\n    };\n    sidebar: null;\n    typography: null;\n    buttons: {\n      primary: {\n        backgroundColor: string | null;\n        textColor: string | null;\n        hoverBackgroundColor: string | null;\n      };\n     secondary: {\n        backgroundColor: string | null;\n        textColor: string | null;\n        hoverBackgroundColor: string | null;\n      };\n    };\n    borders: null;\n    spacing: null;\n  };\n  urls: {\n    faviconUrl: null;\n    logoUrl: null;\n  };\n};\n\n/**\n * Build the init_config object that Control Center expects\n * from the simple MerchantTheme contract.\n *\n * Any missing value is set to null.\n */\nexport function buildInitConfig(merchantTheme: MerchantTheme | undefined | null): InitConfig {\n  const safeTheme = merchantTheme || {};\n\n  return {\n    settings: {\n      colors: {\n        primary: safeTheme.primaryColor ?? null,\n        secondary: null,\n        background: safeTheme.backgroundColor ?? null\n      },\n      sidebar: null,\n      typography: null,\n      buttons: {\n        primary: {\n          backgroundColor: safeTheme.buttons?.primary?.backgroundColor ?? null,\n          textColor: safeTheme.buttons?.primary?.textColor ?? null,\n          hoverBackgroundColor: safeTheme.buttons?.primary?.hoverBackgroundColor ?? null\n        },\n        secondary: {\n          backgroundColor: safeTheme.buttons?.secondary?.backgroundColor ?? null,\n          textColor: safeTheme.buttons?.secondary?.textColor ?? null,\n          hoverBackgroundColor: safeTheme.buttons?.secondary?.hoverBackgroundColor ?? null\n        }\n      },\n      borders: null,\n      spacing: null\n    },\n    urls: {\n      faviconUrl: null,\n      logoUrl: null\n    }\n  };\n}\n\n\n","export { loadHyperswitch, Hyperswitch } from './hyperswitch';\nexport { HyperswitchElement } from './element';\nexport { ConnectorConfigurationComponent } from './connector-configuration';\nexport type { HyperswitchInitOptions, ElementOptions } from './types';\nexport type { MerchantTheme } from './init-config';\n\nexport const VERSION = '1.0.0';\n"],"names":["isBrowser","window","document","HyperswitchElement","instance","options","this","_internalId","Math","random","toString","substring","boundMessageHandler","element","createElement","iframe","handleMessage","bind","setupElement","setupIframe","addEventListener","prototype","className","trim","dataset","hyperswitchElement","getElementType","Object","assign","style","__assign","width","height","overflow","src","getIframeSrc","border","title","concat","setAttribute","appendChild","event","onMessage","data","_a","type","newHeight","component","onResize","clientWidth","mount","domNode","Error","parent","querySelector","destroy","removeEventListener","parentNode","removeChild","getIframe","ConnectorConfigurationComponent","_super","call","__extends","baseUrl","url","Hyperswitch","token","initConfig","activeElements","Map","isRefetchingToken","tokenError","fetchToken","merchantTheme","safeTheme","settings","colors","primary","primaryColor","secondary","background","_b","backgroundColor","sidebar","typography","buttons","_e","_d","_c","textColor","_h","_g","_f","hoverBackgroundColor","_l","_k","_j","_p","_o","_m","_s","_r","_q","_v","_u","_t","borders","spacing","urls","faviconUrl","logoUrl","initPromise","fetchInitialToken","listenForMessages","_this","error","Promise","reject","then","catch","message","String","__awaiter","value","refetchAndBroadcastToken","sent","forEach","contentWindow","source","onElementIframeLoaded","newToken","elementId","postMessage","sendErrorToActiveElements","error_1","errorMessage","create","set","setTimeout","init_config"],"mappings":"wnEAGA,IAAMA,EAA8B,oBAAXC,QAA8C,oBAAbC,SAE1DC,EAAA,WAQE,SAAYA,EAAAC,EAAuBC,GACjCC,KAAKF,SAAWA,EAChBE,KAAKD,QAAUA,GAAW,GAC1BC,KAAKC,YAAc,mBAAYC,KAAKC,SAASC,SAAS,IAAIC,UAAU,IACpEL,KAAKM,oBAAsB,KAItBZ,IAILM,KAAKO,QAAUX,SAASY,cAAc,OACtCR,KAAKS,OAASb,SAASY,cAAc,UACrCR,KAAKM,oBAAsBN,KAAKU,cAAcC,KAAKX,MAEnDA,KAAKY,eACLZ,KAAKa,cACLlB,OAAOmB,iBAAiB,UAAWd,KAAKM,qBACzC,CAgGH,OA9FUT,EAAAkB,UAAAH,aAAR,WACOlB,IAILM,KAAKO,QAAQS,UAAY,8BAAuBhB,KAAKD,QAAQiB,WAAa,IAAKC,OAC/EjB,KAAKO,QAAQW,QAAQC,mBAAqBnB,KAAKoB,iBAE/CC,OAAOC,OAAOtB,KAAKO,QAAQgB,MAAKC,EAAA,CAC9BC,MAAOzB,KAAKD,QAAQ0B,OAAS,OAC7BC,OAAQ1B,KAAKD,QAAQ2B,QAAU,QAC/BC,SAAU,UACN3B,KAAKD,QAAQwB,OAAS,CAAA,MAItB1B,EAAAkB,UAAAF,YAAR,WACOnB,IAILM,KAAKS,OAAOmB,IAAM5B,KAAK6B,eACvB7B,KAAKS,OAAOc,MAAMO,OAAS,OAC3B9B,KAAKS,OAAOc,MAAME,MAAQ,OAC1BzB,KAAKS,OAAOc,MAAMG,OAAS,OAC3B1B,KAAKS,OAAOsB,MAAQ,eAAeC,OAAAhC,KAAKoB,kBACxCpB,KAAKS,OAAOwB,aAAa,QAAS,8DAClCjC,KAAKS,OAAOwB,aAAa,UAAW,4GAEpCjC,KAAKO,QAAQ2B,YAAYlC,KAAKS,UAGxBZ,EAAakB,UAAAL,cAArB,SAAsByB,SACpB,GAAKzC,IAIDM,KAAKD,QAAQqC,WACfpC,KAAKD,QAAQqC,UAAUD,EAAME,MAGN,uCAArBC,EAAAH,EAAME,2BAAME,OAAsC,CACpD,IAAMC,EAAYL,EAAME,KAAKX,QACJS,EAAME,KAAKI,WAAa,MAExBzC,KAAKoB,kBAAyC,iBAAdoB,GAA0BA,EAAY,IAC7FxC,KAAKO,QAAQgB,MAAMG,OAAS,GAAAM,OAAGQ,EAAS,MAEpCxC,KAAKD,QAAQ2C,UACf1C,KAAKD,QAAQ2C,SAAS,CACpBjB,MAAOzB,KAAKO,QAAQoC,YACpBjB,OAAQc,IAIf,GAGH3C,EAAKkB,UAAA6B,MAAL,SAAMC,GACJ,IAAKnD,EACH,MAAM,IAAIoD,MAAM,wEAGlB,IAAMC,EAA4B,iBAAZF,EAClBjD,SAASoD,cAAcH,GACvBA,EAEJ,IAAKE,EACH,MAAM,IAAID,MAAM,+BAAwBD,IAI1C,OADAE,EAAOb,YAAYlC,KAAKO,SACjBP,MAGTH,EAAAkB,UAAAkC,QAAA,WACOvD,IAGDM,KAAKM,qBACPX,OAAOuD,oBAAoB,UAAWlD,KAAKM,qBAGzCN,KAAKO,SAAWP,KAAKO,QAAQ4C,YAC/BnD,KAAKO,QAAQ4C,WAAWC,YAAYpD,KAAKO,WAOtCV,EAAAkB,UAAAsC,UAAP,WACE,OAAOrD,KAAKS,QAEfZ,CAAD,IC5HAyD,EAAA,SAAAC,GACE,SAAYD,EAAAxD,EAAuBC,GACjC,OAAAwD,EAAMC,KAAAxD,KAAAF,EAAUC,IAASC,IAC1B,CAUH,0PAbqDyD,CAAkBH,EAAAC,GAK3DD,EAAAvC,UAAAK,eAAV,WACE,MAAO,cAGCkC,EAAAvC,UAAAc,aAAV,WACE,IAAM6B,EAAU1D,KAAKD,QAAQ4D,KAAO,wBACpC,MAAO,GAAA3B,OAAG0B,EAAO,yBAEpBJ,CAAD,CAbA,CAAqDzD,GCCrD,IAAMH,EAA8B,oBAAXC,OAEzBiE,EAAA,WASE,SAAAA,EAAY7D,GACV,GATMC,KAAK6D,MAAkB,KAEvB7D,KAAU8D,WAAsB,KAChC9D,KAAA+D,eAAsD,IAAIC,IAC1DhE,KAAiBiE,mBAAY,EAE7BjE,KAAUkE,WAAkB,MAG7BnE,GAAyC,mBAAvBA,EAAQoE,WAC7B,MAAM,IAAIrB,MAAM,2DCsDhB,IAA0BsB,0CACxBC,EDpDJrE,KAAKmE,WAAapE,EAAQoE,WACzBnE,KAAK8D,WAAa/D,EAAQ+D,YCkDCM,EDlD4BrE,EAAQ+D,WCqD3D,CACLQ,SAAU,CACRC,OAAQ,CACNC,gBAASlC,GALT+B,EAAYD,GAAiB,IAKVK,4BAAgB,KACnCC,UAAW,KACXC,mBAAYC,EAAAP,EAAUQ,+BAAmB,MAE3CC,QAAS,KACTC,WAAY,KACZC,QAAS,CACPR,QAAS,CACPK,gBAA4D,QAA3CI,EAA0B,QAA1BC,EAAiB,QAAjBC,EAAAd,EAAUW,eAAO,IAAAG,OAAA,EAAAA,EAAEX,eAAO,IAAAU,OAAA,EAAAA,EAAEL,uBAAe,IAAAI,EAAAA,EAAI,KAChEG,UAAgD,QAArCC,EAA0B,QAA1BC,EAAiB,QAAjBC,EAAAlB,EAAUW,eAAO,IAAAO,OAAA,EAAAA,EAAEf,eAAO,IAAAc,OAAA,EAAAA,EAAEF,iBAAS,IAAAC,EAAAA,EAAI,KACpDG,qBAAsE,QAAhDC,EAA0B,QAA1BC,EAAiB,QAAjBC,EAAAtB,EAAUW,eAAO,IAAAW,OAAA,EAAAA,EAAEnB,eAAO,IAAAkB,OAAA,EAAAA,EAAEF,4BAAoB,IAAAC,EAAAA,EAAI,MAE5Ef,UAAW,CACTG,gBAA8D,QAA7Ce,EAA4B,QAA5BC,EAAiB,QAAjBC,EAAAzB,EAAUW,eAAO,IAAAc,OAAA,EAAAA,EAAEpB,iBAAS,IAAAmB,OAAA,EAAAA,EAAEhB,uBAAe,IAAAe,EAAAA,EAAI,KAClER,UAAkD,QAAvCW,EAA4B,QAA5BC,EAAiB,QAAjBC,EAAA5B,EAAUW,eAAO,IAAAiB,OAAA,EAAAA,EAAEvB,iBAAS,IAAAsB,OAAA,EAAAA,EAAEZ,iBAAS,IAAAW,EAAAA,EAAI,KACtDP,qBAAwE,QAAlDU,EAA4B,QAA5BC,EAAiB,QAAjBC,EAAA/B,EAAUW,eAAO,IAAAoB,OAAA,EAAAA,EAAE1B,iBAAS,IAAAyB,OAAA,EAAAA,EAAEX,4BAAoB,IAAAU,EAAAA,EAAI,OAGhFG,QAAS,KACTC,QAAS,MAEXC,KAAM,CACJC,WAAY,KACZC,QAAS,QD/EmE,KAC9EzG,KAAK0G,YAAc1G,KAAK2G,oBACxB3G,KAAK4G,mBACN,CAoKH,OAlKUhD,EAAA7C,UAAA4F,kBAAR,WAAA,IAkBCE,EAAA7G,KATC,OAR0B,WACxB,IACE,OAAO6G,EAAK1C,YACb,CAAC,MAAO2C,GACP,OAAOC,QAAQC,OAAOF,EACvB,CACF,CANyB,GAQDG,KAAK,SAACpD,GACzBA,EACFgD,EAAKhD,MAAQA,EAEbgD,EAAK3C,WAAa,0DAEtB,GAAGgD,MAAM,SAACJ,GACRD,EAAK3C,WAAa,0BAAAlC,OAA0B8E,aAAiBhE,MAAQgE,EAAMK,QAAUC,OAAON,GAC9F,IAGMlD,EAAA7C,UAAA6F,kBAAR,WAAA,IAqBCC,EAAA7G,KApBMN,GAOLC,OAAOmB,iBAAiB,UAAW,SAAOqB,GAAK,OAAAkF,EAAAR,OAAA,OAAA,EAAA,mFACpB,mBAAT,UAAZ1E,EAAME,YAAM,IAAAC,OAAA,EAAAA,EAAAC,QAAkD,KAAZ,QAAVqC,EAAAzC,EAAME,YAAI,IAAAuC,OAAA,EAAAA,EAAE0C,OAAc,CAAA,EAAA,GACpE,CAAA,EAAMtH,KAAKuH,0CAAXrC,EAAAsC,oBAC8B,mCAArBrC,EAAAhD,EAAME,2BAAME,OAErBvC,KAAK+D,eAAe0D,QAAQ,SAAClH,GAC3B,IAAME,EAASF,EAAQ8C,aACnB5C,aAAA,EAAAA,EAAQiH,iBAAkBvF,EAAMwF,QAClCd,EAAKe,sBAAsBrH,EAE/B,gCAEH,EAAA,IAGWqD,EAAA7C,UAAAwG,yBAAd,kHACE,GAAIvH,KAAKiE,kBACP,MAAO,CAAA,GAGTjE,KAAKiE,mBAAoB,mBAGN,8BAAA,CAAA,EAAMjE,KAAKmE,4BAAtB0D,EAAWvF,EAAuBkF,SAGtCxH,KAAK6D,MAAQgE,EACb7H,KAAKkE,WAAa,KAClBlE,KAAK+D,eAAe0D,QAAQ,SAAClH,EAASuH,GACpC,IAAMrH,EAASF,EAAQ8C,aACnB5C,aAAM,EAANA,EAAQiH,gBACVjH,EAAOiH,cAAcK,YAAY,CAC/BxF,KAAM,aACNsB,MAAOgD,EAAKhD,OACX,IAEP,KAEA7D,KAAKkE,WAAa,6DAClBlE,KAAKgI,0BAA0BhI,KAAKkE,4CAGtClE,KAAKkE,WAAa,4BAAAlC,OAA4BiG,aAAiBnF,MAAQmF,EAAMd,QAAUC,OAAOa,IAC9FjI,KAAKgI,0BAA0BhI,KAAKkE,gCAEpClE,KAAKiE,mBAAoB,2BAE5B,EAEOL,EAAyB7C,UAAAiH,0BAAjC,SAAkCE,GAChClI,KAAK+D,eAAe0D,QAAQ,SAAClH,GAC3B,IAAME,EAASF,EAAQ8C,aACnB5C,aAAM,EAANA,EAAQiH,gBACVjH,EAAOiH,cAAcK,YAAY,CAC/BxF,KAAM,aACNuE,MAAOoB,GACN,IAEP,IAGKtE,EAAA7C,UAAAoH,OAAP,SAAc5F,EAAcxC,GAC1B,IAAIQ,EAEJ,GACO,eADCgC,EAKJ,MAAM,IAAIO,MAAM,gCAAyBP,IAK7C,OARIhC,EAAU,IAAI+C,EAAgCtD,KAAMD,GAMxDC,KAAK+D,eAAeqE,IAAI7H,EAAQN,YAAaM,GAEtCA,GAGFqD,EAAqB7C,UAAA6G,sBAA5B,SAA6BrH,GAA7B,IAwDCsG,EAAA7G,KAvDCA,KAAK0G,YAAYO,KAAK,WACpB,IAAMxG,EAASF,EAAQ8C,aAClB5C,aAAA,EAAAA,EAAQiH,gBAIbW,WAAW,WACT,IACE,IAAMX,EAAgBjH,EAAOiH,cAC7B,IAAKA,EACH,OAGEb,EAAK3C,WACPwD,EAAcK,YAAY,CACxBxF,KAAM,aACNuE,MAAOD,EAAK3C,YACX,KACM2C,EAAKhD,MACd6D,EAAcK,YAAY,CACxBxF,KAAM,aACNsB,MAAOgD,EAAKhD,OACX,KAEH6D,EAAcK,YAAY,CACxBxF,KAAM,aACNuE,MAAO,sBACN,KAIDD,EAAK/C,YACP4D,EAAcK,YAAY,CACxBxF,KAAM,cACN+F,YAAazB,EAAK/C,YACjB,IAEN,CAAC,MAAOgD,GACR,CACF,EAAE,IACL,GAAGI,MAAM,SAACJ,GACR,IAAMrG,EAASF,EAAQ8C,YACjBqE,EAAgBjH,aAAA,EAAAA,EAAQiH,cAC1BA,GACFW,WAAW,WACT,IACEX,EAAcK,YAAY,CACxBxF,KAAM,aACNuE,MAAO,gCAAgC9E,OAAA8E,aAAiBhE,MAAQgE,EAAMK,QAAUC,OAAON,KACtF,IACJ,CAAC,MAAAxE,GACD,CACF,EAAE,IAEP,IAEHsB,CAAD,yFEvLuB,0BFyLjB,SAA0B7D,GAC9B,OAAO,IAAI6D,EAAY7D,EACzB"}